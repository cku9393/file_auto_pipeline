{% extends "base.html" %}

{% block title %}í…œí”Œë¦¿ ê´€ë¦¬ - Manufacturing Docs{% endblock %}

{% block content %}
<div class="container">
    <header class="page-header">
        <div>
            <h1>ğŸ“‹ í…œí”Œë¦¿ ê´€ë¦¬</h1>
            <p>ë³´ê³ ì„œ í…œí”Œë¦¿ì„ ê´€ë¦¬í•©ë‹ˆë‹¤.</p>
        </div>
        <a href="/templates/register" class="btn-primary">+ ìƒˆ í…œí”Œë¦¿</a>
    </header>

    <!-- í•„í„° -->
    <div class="filters">
        <select id="status-filter"
                hx-get="/api/templates"
                hx-target="#template-list"
                hx-trigger="change"
                hx-include="this">
            <option value="">ì „ì²´ ìƒíƒœ</option>
            <option value="ready">ì‚¬ìš© ê°€ëŠ¥</option>
            <option value="draft">ì‘ì„± ì¤‘</option>
            <option value="archived">ë³´ê´€ë¨</option>
        </select>

        <select id="category-filter"
                hx-get="/api/templates"
                hx-target="#template-list"
                hx-trigger="change"
                hx-include="this">
            <option value="all">ì „ì²´</option>
            <option value="base">ê¸°ë³¸ í…œí”Œë¦¿</option>
            <option value="custom">ì‚¬ìš©ì ì •ì˜</option>
        </select>
    </div>

    <!-- í…œí”Œë¦¿ ëª©ë¡ -->
    <div id="template-list"
         hx-get="/api/templates"
         hx-trigger="load"
         hx-swap="innerHTML">
        <div class="loading-placeholder">ë¡œë”© ì¤‘...</div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// í…œí”Œë¦¿ ìƒíƒœ ë³€ê²½
function changeStatus(templateId, newStatus) {
    htmx.ajax('PATCH', `/api/templates/${templateId}`, {
        values: { status: newStatus },
        target: '#template-list',
        swap: 'innerHTML'
    }).then(() => {
        htmx.trigger('#template-list', 'load');
    });
}

// í…œí”Œë¦¿ ì‚­ì œ
function deleteTemplate(templateId) {
    if (!confirm(`ì •ë§ '${templateId}' í…œí”Œë¦¿ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
        return;
    }

    htmx.ajax('DELETE', `/api/templates/${templateId}`, {
        target: '#template-list',
        swap: 'innerHTML'
    }).then(() => {
        htmx.trigger('#template-list', 'load');
    });
}
</script>
{% endblock %}
