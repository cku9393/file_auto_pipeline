{% extends "base.html" %}

{% block title %}í…œí”Œë¦¿ ë“±ë¡ - Manufacturing Docs{% endblock %}

{% block content %}
<div class="container">
    <header>
        <h1>ğŸ“„ í…œí”Œë¦¿ ë“±ë¡</h1>
        <p>ì˜ˆì‹œ ë¬¸ì„œë¥¼ ì—…ë¡œë“œí•˜ì—¬ ìƒˆ í…œí”Œë¦¿ì„ ìƒì„±í•©ë‹ˆë‹¤.</p>
    </header>

    <form class="register-form"
          hx-post="/api/templates"
          hx-encoding="multipart/form-data"
          hx-target="#result"
          hx-indicator="#loading">

        <section class="form-section">
            <h2>1ë‹¨ê³„: ê¸°ë³¸ ì •ë³´</h2>

            <div class="form-group">
                <label for="template_id">í…œí”Œë¦¿ ID *</label>
                <input type="text" id="template_id" name="template_id"
                       placeholder="customer_a_inspection"
                       pattern="[a-z0-9_]+"
                       maxlength="50"
                       required>
                <small>ì†Œë¬¸ì, ìˆ«ì, ë°‘ì¤„ë§Œ í—ˆìš© (ìµœëŒ€ 50ì)</small>
            </div>

            <div class="form-group">
                <label for="display_name">í‘œì‹œ ì´ë¦„ *</label>
                <input type="text" id="display_name" name="display_name"
                       placeholder="ê³ ê°ì‚¬A ê²€ì‚¬ì„±ì ì„œ"
                       required>
            </div>

            <div class="form-group">
                <label for="doc_type">ë¬¸ì„œ íƒ€ì…</label>
                <select id="doc_type" name="doc_type">
                    <option value="inspection">ê²€ì‚¬ì„±ì ì„œ</option>
                    <option value="report">ë³´ê³ ì„œ</option>
                    <option value="certificate">ì„±ì ì„œ</option>
                    <option value="other">ê¸°íƒ€</option>
                </select>
            </div>

            <div class="form-group">
                <label for="description">ì„¤ëª…</label>
                <textarea id="description" name="description"
                          placeholder="í…œí”Œë¦¿ì— ëŒ€í•œ ì„¤ëª…..."
                          rows="3"></textarea>
            </div>
        </section>

        <section class="form-section">
            <h2>2ë‹¨ê³„: ì˜ˆì‹œ íŒŒì¼ ì—…ë¡œë“œ</h2>

            <div class="form-group">
                <label for="example_docx">ì˜ˆì‹œ Word íŒŒì¼ (.docx)</label>
                <input type="file" id="example_docx" name="example_docx"
                       accept=".docx">
                <small>placeholderê°€ ìˆìœ¼ë©´ ìë™ ê°ì§€ë©ë‹ˆë‹¤</small>
            </div>

            <div class="form-group">
                <label for="example_xlsx">ì˜ˆì‹œ Excel íŒŒì¼ (.xlsx)</label>
                <input type="file" id="example_xlsx" name="example_xlsx"
                       accept=".xlsx">
                <small>Named Range ì‚¬ìš© ê¶Œì¥</small>
            </div>
        </section>

        <div class="form-actions">
            <button type="button" class="btn-secondary" onclick="history.back()">ì·¨ì†Œ</button>
            <button type="submit" class="btn-primary">ë¶„ì„ ë° ë“±ë¡</button>
        </div>
    </form>

    <div id="loading" class="loading-indicator">
        <span>ë¶„ì„ ì¤‘...</span>
    </div>

    <div id="result"></div>
</div>
{% endblock %}

{% block scripts %}
<script>
// í…œí”Œë¦¿ ID ìë™ ìƒì„± (í‘œì‹œ ì´ë¦„ ê¸°ë°˜)
document.getElementById('display_name').addEventListener('blur', function(e) {
    const templateIdInput = document.getElementById('template_id');
    if (!templateIdInput.value) {
        const suggested = e.target.value
            .toLowerCase()
            .replace(/[^a-z0-9ê°€-í£]/g, '_')
            .replace(/_{2,}/g, '_')
            .replace(/^_|_$/g, '')
            .substring(0, 50);
        templateIdInput.value = suggested;
    }
});
</script>
{% endblock %}
