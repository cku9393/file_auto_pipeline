{% extends "base.html" %}

{% block title %}ì‘ì—… ì´ë ¥ - Manufacturing Docs{% endblock %}

{% block content %}
<div class="container">
    <header class="page-header">
        <div>
            <h1>ğŸ“ ì‘ì—… ì´ë ¥</h1>
            <p>ìƒì„±ëœ ë¬¸ì„œë¥¼ ì¡°íšŒí•˜ê³  ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤.</p>
        </div>
        <a href="/chat" class="btn-primary">+ ìƒˆ ë¬¸ì„œ</a>
    </header>

    <!-- í•„í„° -->
    <div class="filters">
        <input type="text" id="search-input"
               placeholder="Job ID ë˜ëŠ” WO ê²€ìƒ‰..."
               hx-get="/api/generate/jobs"
               hx-target="#job-list"
               hx-trigger="keyup changed delay:300ms"
               hx-include="this">

        <select id="status-filter"
                hx-get="/api/generate/jobs"
                hx-target="#job-list"
                hx-trigger="change"
                hx-include="this">
            <option value="">ì „ì²´ ìƒíƒœ</option>
            <option value="success">ì„±ê³µ</option>
            <option value="failed">ì‹¤íŒ¨</option>
            <option value="pending">ì§„í–‰ ì¤‘</option>
        </select>

        <select id="limit-filter" name="limit"
                hx-get="/api/generate/jobs"
                hx-target="#job-list"
                hx-trigger="change"
                hx-include="this">
            <option value="20">20ê°œ</option>
            <option value="50">50ê°œ</option>
            <option value="100">100ê°œ</option>
        </select>
    </div>

    <!-- ì‘ì—… ëª©ë¡ -->
    <div id="job-list"
         hx-get="/api/generate/jobs"
         hx-trigger="load"
         hx-swap="innerHTML">
        <div class="loading-placeholder">ë¡œë”© ì¤‘...</div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// íŒŒì¼ ë‹¤ìš´ë¡œë“œ
function downloadFile(jobId, filename) {
    window.location.href = `/api/generate/jobs/${jobId}/download/${filename}`;
}

// ì „ì²´ ë‹¤ìš´ë¡œë“œ (ZIP)
function downloadAll(jobId) {
    window.location.href = `/api/generate/jobs/${jobId}/download`;
}

// ì‘ì—… ìƒì„¸ ë³´ê¸°
function viewJobDetail(jobId) {
    window.location.href = `/generate/jobs/${jobId}`;
}
</script>
{% endblock %}
